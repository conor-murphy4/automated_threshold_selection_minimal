---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Automated Threshold Selection and Associated Inference Uncertainty for Univariate Extremes

This minimal repository contains R code to generate table 5 and table 7 in the paper "Automated threshold selection and associated inference uncertainty for univariate extremes".

Code to reproduce all results from the main paper and supplementary material is available at this GitHub repository. (link redacted for anonymity during review)

## Required Packages

The following code snippet with install the packages required to run the code in this repository.

```{r, eval=FALSE}
required_packages <- c("evir", "ismev", "Metrics", "mgcv", "nlme", "threshr")
install.packages(required_packages)
```


## Getting Started 

### Generate Table 5

Table 5 of the main paper compares the EQD, Wadsworth and Northrop methods for extreme value threshold selection on Gaussian data. Thresholds are chosen using each method for 500 samples at each of two different sample sizes, $n = 2000$ and $n = 20,000$.

![](readme-images/table-5.png)

This table can be generated using the file `Table_5_RMSE_quantiles_gaussian.R`. 

```{r}
source("Table_5_RMSE_quantiles_gaussian.R")
```

Generating the full table takes quite some time and so we offer two meta-parameters at the top of this script to allow faster validation. 

- `GENERATE_DATA`: Generate Gaussian data and threshold estimates (`TRUE`) or use those saved in the output folder (`FALSE`)?

- `FULL_TABLE`: Generate estimates for both $n = 20,000$ and $n = 2000$ (`TRUE`) or n = 2000 only (`FALSE`)?

Approximate run-times are given in the table below. 

| `GENERATE_DATA` | `FULL_TABLE` | Approximate Run Time |
|-----------------|--------------|----------------------|
| FALSE           | FALSE        | 0.2 seconds          |
| FALSE           | TRUE         | 0.2 seconds          |
| TRUE            | FALSE        | 30 minutes           |
| TRUE            | TRUE         | ????                 |


### Generate Table 7

Table 7 of the main paper compares the thresholds selected by the EQD, Wadsworth and Northrop methods when applied to the river Nidd dataset for each of 7 possible candidate threshold grids. 

![](readme-images/table-7.png)

This table can be generated using the file `Table_5_RMSE_quantiles_gaussian.R`. This will take approximately 1 minute to run. 

```{r, warning=FALSE}
source("Table_7_River_Nidd_dataset_selected_thresholds.R")
```

# To Do 

- [ ] Give directory and repo an informative name. "Code_submission_technometrics" >> something linked to paper title.

- [] Run full table 5 and give approximate time with `{tictoc}`.